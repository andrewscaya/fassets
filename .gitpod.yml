# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/introduction/learn-gitpod/gitpod-yaml)
# and commit this file to your remote git repository to share the goodness with others.

# Learn more from ready-to-use templates: https://www.gitpod.io/docs/introduction/getting-started/quickstart

tasks:

  - name: Install node modules
    init: |
      yarn install --frozen-lockfile
      gp sync-done install_node_modules

  - name: Compile contracts
    command: |
      gp sync-await install_node_modules
      yarn run compile
      gp sync-done compile_contracts


  # RUN TESTS

  - name: "Test: unit/fasset/mock"
    env:
      TEST_PATH: ./test/unit/fasset/mock
    command: |
      gp-sync-await install_node_modules
      yarn hardhat test --network hardhat || bash

  - name: "Test: unit/fasset/governance"
    env:
      TEST_PATH: ./test/unit/fasset/governance
    command: |
      gp-sync-await install_node_modules
      yarn hardhat test --network hardhat || bash

  - name: "Test: unit/fasset/utils"
    env:
      TEST_PATH: ./test/unit/fasset/utils
    command: |
      gp-sync-await install_node_modules
      yarn hardhat test --network hardhat || bash

  - name: "Test: unit/fasset/addressValidator"
    env:
      TEST_PATH: ./test/unit/fasset/addressValidator
    command: |
      gp-sync-await install_node_modules
      yarn hardhat test --network hardhat || bash

  - name: "Test: unit/fasset/library"
    env:
      TEST_PATH: ./test/unit/fasset/library
    command: |
      gp-sync-await install_node_modules
      yarn hardhat test --network hardhat || bash

  - name: "Test: unit/fasset/implementation"
    env:
      TEST_PATH: ./test/unit/fasset/implementation
    command: |
      gp-sync-await install_node_modules
      yarn hardhat test --network hardhat || bash

  - name: "Test: unit/bots"
    env:
      TEST_PATH: ./test/unit/bots
    command: |
      gp-sync-await install_node_modules
      yarn hardhat test --network hardhat || bash

  - name: "Test: unit/gasReport/GasReport.ts"
    command: |
      gp-sync-await install_node_modules
      yarn hardhat test --network hardhat test/unit/gasReport/GasReport.ts || bash

  - name: "Test: contract integration"
    command: |
      gp-sync-await install_node_modules
      yarn run test_integration_hh || bash

  - name: "Test: linter"
    command: |
      gp-sync-await install_node_modules
      yarn run lint || bash